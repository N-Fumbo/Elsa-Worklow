{"version":3,"names":["WorkflowDefinitionActivityVersionSettings","this","onUpdateClick","activity","renderContext","version","latestAvailablePublishedVersion","workflowDefinitionVersionId","latestAvailablePublishedVersionId","currentVersion","notifyActivityChanged","onRenderContextChanged","value","_a","componentWillLoad","render","h","activityId","id","upgradeAvailable","key","versionDetails","toString","InfoList","title","dictionary","class","onClick","e"],"sources":["./src/modules/workflow-definitions/components/activity-properties/activity-version-settings.tsx"],"sourcesContent":["import {h, Component, Prop, State, Watch} from \"@stencil/core\";\nimport {RenderActivityPropsContext, WorkflowDefinitionActivity} from \"../models\";\nimport {isNullOrWhitespace} from \"../../../../utils\";\nimport {InfoList} from \"../../../../components/shared/forms/info-list\";\n\n@Component({\n  tag: 'elsa-workflow-definition-activity-version-settings',\n  shadow: false\n})\nexport class WorkflowDefinitionActivityVersionSettings {\n\n  @Prop() renderContext: RenderActivityPropsContext;\n\n  @State() private currentVersion: number;\n\n  @Watch('renderContext')\n  onRenderContextChanged(value: RenderActivityPropsContext) {\n    const activity = value?.activity as WorkflowDefinitionActivity;\n    this.currentVersion = activity?.version ?? 0;\n  }\n\n  componentWillLoad() {\n    this.onRenderContextChanged(this.renderContext);\n  }\n\n  render() {\n\n    if (!this.renderContext)\n      return <div/>;\n\n    const activity = this.renderContext.activity as WorkflowDefinitionActivity;\n    const activityId = activity.id;\n    const latestAvailablePublishedVersion = activity.latestAvailablePublishedVersion;\n    const upgradeAvailable = activity.version < latestAvailablePublishedVersion;\n    const key = `${activityId}`;\n\n    const versionDetails = {\n      'Current version': this.currentVersion.toString(),\n      'Published version': latestAvailablePublishedVersion?.toString() ?? '-',\n    };\n\n    return <div key={key}>\n      <InfoList title=\"Version\" dictionary={versionDetails}/>\n      {upgradeAvailable &&\n        <div>\n          <button class=\"elsa-btn elsa-btn-default\" onClick={e => this.onUpdateClick()}>Upgrade</button>\n        </div>}\n    </div>\n  }\n\n  private onUpdateClick = () => {\n    const activity = this.renderContext.activity as WorkflowDefinitionActivity;\n    activity.version = activity.latestAvailablePublishedVersion;\n    activity.workflowDefinitionVersionId = activity.latestAvailablePublishedVersionId;\n    this.currentVersion = activity.version;\n    this.renderContext.notifyActivityChanged();\n  };\n}\n"],"mappings":"6PASaA,EAAyC,M,yBAyC5CC,KAAAC,cAAgB,KACtB,MAAMC,EAAWF,KAAKG,cAAcD,SACpCA,EAASE,QAAUF,EAASG,gCAC5BH,EAASI,4BAA8BJ,EAASK,kCAChDP,KAAKQ,eAAiBN,EAASE,QAC/BJ,KAAKG,cAAcM,uBAAuB,E,2DAvC5CC,uBAAuBC,G,MACrB,MAAMT,EAAWS,IAAK,MAALA,SAAK,SAALA,EAAOT,SACxBF,KAAKQ,gBAAiBI,EAAAV,IAAQ,MAARA,SAAQ,SAARA,EAAUE,WAAO,MAAAQ,SAAA,EAAAA,EAAI,C,CAG7CC,oBACEb,KAAKU,uBAAuBV,KAAKG,c,CAGnCW,S,MAEE,IAAKd,KAAKG,cACR,OAAOY,EAAA,YAET,MAAMb,EAAWF,KAAKG,cAAcD,SACpC,MAAMc,EAAad,EAASe,GAC5B,MAAMZ,EAAkCH,EAASG,gCACjD,MAAMa,EAAmBhB,EAASE,QAAUC,EAC5C,MAAMc,EAAM,GAAGH,IAEf,MAAMI,EAAiB,CACrB,kBAAmBpB,KAAKQ,eAAea,WACvC,qBAAqBT,EAAAP,IAA+B,MAA/BA,SAA+B,SAA/BA,EAAiCgB,cAAU,MAAAT,SAAA,EAAAA,EAAI,KAGtE,OAAOG,EAAA,OAAKI,IAAKA,GACfJ,EAACO,EAAQ,CAACC,MAAM,UAAUC,WAAYJ,IACrCF,GACCH,EAAA,WACEA,EAAA,UAAQU,MAAM,4BAA4BC,QAASC,GAAK3B,KAAKC,iBAAe,Y"}