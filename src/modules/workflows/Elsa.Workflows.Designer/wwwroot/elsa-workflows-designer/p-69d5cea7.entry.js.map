{"version":3,"names":["InputTagsDropdown","this","updateCurrentValues","newValue","dropdownValues","values","forEach","value","valueKey","tag","find","x","push","currentValues","valuesChangedHandler","componentWillLoad","async","e","preventDefault","input","target","currentTag","text","options","selectedIndex","trim","length","uniq","valueChanged","emit","filter","render","dropdownItems","findIndex","y","Array","isArray","valuesJson","JSON","stringify","map","h","class","href","onClick","onDeleteTagClick","type","id","fieldId","onChange","onTagSelected","disabled","selected","placeHolder","name","fieldName"],"sources":["./src/components/shared/input-tags/input-tags-dropdown.tsx"],"sourcesContent":["import {Component, h, Prop, Event, EventEmitter, State, Watch} from '@stencil/core';\nimport {uniq} from 'lodash';\nimport {SelectListItem} from '../../../models';\n\n@Component({\n  tag: 'elsa-input-tags-dropdown',\n  shadow: false,\n})\nexport class InputTagsDropdown {\n\n  @Prop() fieldName?: string;\n  @Prop() fieldId?: string;\n  @Prop() placeHolder?: string = 'Add tag';\n  @Prop() values?: Array<string | SelectListItem> = [];\n  @Prop() dropdownValues?: Array<SelectListItem> = [];\n  @Event({bubbles: true}) valueChanged: EventEmitter<SelectListItem[]| string[]>;\n  @State() currentValues?: Array<SelectListItem> = [];\n\n  @Watch('values')\n  private valuesChangedHandler(newValue: Array<string | SelectListItem>) {\n    this.updateCurrentValues(newValue);\n  }\n\n  public componentWillLoad() {\n    this.updateCurrentValues(this.values);\n  }\n\n  private updateCurrentValues = (newValue: Array<string | SelectListItem>) => {\n    const dropdownValues = this.dropdownValues || [];\n    let values: Array<SelectListItem> = [];\n\n    if (!!newValue) {\n      newValue.forEach(value => {\n        const valueKey = typeof (value) == 'string' ? value as string : (value as SelectListItem).value;\n        const tag = dropdownValues.find(x => x.value == valueKey);\n\n        if (!!tag)\n          values.push(tag);\n      })\n    }\n\n    this.currentValues = values;\n  };\n\n  private async onTagSelected(e: any) {\n    e.preventDefault();\n\n    const input = e.target as HTMLSelectElement;\n    const currentTag: SelectListItem = {\n      text: input.options[input.selectedIndex].text.trim(),\n      value: input.value\n    }\n\n    if (currentTag.value.length == 0)\n      return;\n\n    const values: Array<SelectListItem> = uniq([...this.currentValues, currentTag]);\n    input.value = \"Add\";\n    await this.valueChanged.emit(values);\n  }\n\n  async onDeleteTagClick(e: any, currentTag: SelectListItem) {\n    e.preventDefault();\n\n    this.currentValues = this.currentValues.filter(tag => tag.value !== currentTag.value);\n    await this.valueChanged.emit(this.currentValues);\n  }\n\n  render() {\n    let values: Array<SelectListItem> = this.currentValues || [];\n    let dropdownItems = this.dropdownValues.filter(x => values.findIndex(y => y.value === x.value) < 0);\n\n    if (!Array.isArray(values))\n      values = [];\n\n    const valuesJson = JSON.stringify(values.map(tag => tag.value));\n\n    return (\n      <div class=\"tw-py-2 tw-px-3 tw-bg-white tw-shadow-sm tw-border tw-border-gray-300 tw-rounded-md\">\n        {values.map(tag => (\n          <a href=\"#\" onClick={e => this.onDeleteTagClick(e, tag)} class=\"tw-inline-block tw-text-xs tw-bg-blue-400 tw-text-white tw-py-2 tw-px-3 tw-mr-1 tw-mb-1 tw-rounded\">\n            <input type=\"hidden\" value={tag.value}/>\n            <span>{tag.text}</span>\n            <span class=\"tw-text-white hover:tw-text-white tw-ml-1\">&times;</span>\n          </a>\n        ))}\n\n        <select\n          id={this.fieldId}\n          class=\"tw-inline-block tw-text-xs tw-py-2 tw-px-3 tw-mr-1 tw-mb-1 tw-pr-8 tw-border-gray-300 focus:tw-outline-none focus:tw-ring-blue-500 focus:tw-border-blue-500 tw-rounded\"\n          onChange={(e) => this.onTagSelected(e)}>\n          <option value=\"Add\" disabled selected>{this.placeHolder}</option>\n          {dropdownItems.map(tag => <option value={tag.value}>{tag.text}</option>)}\n        </select>\n        <input type=\"hidden\" name={this.fieldName} value={valuesJson}/>\n      </div>\n    )\n  }\n}\n"],"mappings":"oHAQaA,EAAiB,M,oEAmBpBC,KAAAC,oBAAuBC,IAC7B,MAAMC,EAAiBH,KAAKG,gBAAkB,GAC9C,IAAIC,EAAgC,GAEpC,KAAMF,EAAU,CACdA,EAASG,SAAQC,IACf,MAAMC,SAAW,GAAkB,SAAWD,EAAmBA,EAAyBA,MAC1F,MAAME,EAAML,EAAeM,MAAKC,GAAKA,EAAEJ,OAASC,IAEhD,KAAMC,EACJJ,EAAOO,KAAKH,EAAI,G,CAItBR,KAAKY,cAAgBR,CAAM,E,iEA7BE,U,YACmB,G,oBACD,G,mBAEA,E,CAGzCS,qBAAqBX,GAC3BF,KAAKC,oBAAoBC,E,CAGpBY,oBACLd,KAAKC,oBAAoBD,KAAKI,O,CAoBxBW,oBAAoBC,GAC1BA,EAAEC,iBAEF,MAAMC,EAAQF,EAAEG,OAChB,MAAMC,EAA6B,CACjCC,KAAMH,EAAMI,QAAQJ,EAAMK,eAAeF,KAAKG,OAC9ClB,MAAOY,EAAMZ,OAGf,GAAIc,EAAWd,MAAMmB,QAAU,EAC7B,OAEF,MAAMrB,EAAgCsB,OAAK,IAAI1B,KAAKY,cAAeQ,IACnEF,EAAMZ,MAAQ,YACRN,KAAK2B,aAAaC,KAAKxB,E,CAG/BW,uBAAuBC,EAAQI,GAC7BJ,EAAEC,iBAEFjB,KAAKY,cAAgBZ,KAAKY,cAAciB,QAAOrB,GAAOA,EAAIF,QAAUc,EAAWd,cACzEN,KAAK2B,aAAaC,KAAK5B,KAAKY,c,CAGpCkB,SACE,IAAI1B,EAAgCJ,KAAKY,eAAiB,GAC1D,IAAImB,EAAgB/B,KAAKG,eAAe0B,QAAOnB,GAAKN,EAAO4B,WAAUC,GAAKA,EAAE3B,QAAUI,EAAEJ,QAAS,IAEjG,IAAK4B,MAAMC,QAAQ/B,GACjBA,EAAS,GAEX,MAAMgC,EAAaC,KAAKC,UAAUlC,EAAOmC,KAAI/B,GAAOA,EAAIF,SAExD,OACEkC,EAAA,OAAKC,MAAM,uFACRrC,EAAOmC,KAAI/B,GACVgC,EAAA,KAAGE,KAAK,IAAIC,QAAS3B,GAAKhB,KAAK4C,iBAAiB5B,EAAGR,GAAMiC,MAAM,sGAC7DD,EAAA,SAAOK,KAAK,SAASvC,MAAOE,EAAIF,QAChCkC,EAAA,YAAOhC,EAAIa,MACXmB,EAAA,QAAMC,MAAM,6CAA2C,QAI3DD,EAAA,UACEM,GAAI9C,KAAK+C,QACTN,MAAM,yKACNO,SAAWhC,GAAMhB,KAAKiD,cAAcjC,IACpCwB,EAAA,UAAQlC,MAAM,MAAM4C,SAAQ,KAACC,SAAQ,MAAEnD,KAAKoD,aAC3CrB,EAAcQ,KAAI/B,GAAOgC,EAAA,UAAQlC,MAAOE,EAAIF,OAAQE,EAAIa,SAE3DmB,EAAA,SAAOK,KAAK,SAASQ,KAAMrD,KAAKsD,UAAWhD,MAAO8B,I"}