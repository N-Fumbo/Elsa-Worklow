import{r as t,c as s,h as e}from"./p-a7a3baa1.js";import{C as i,x as o,J as r,Q as l,o as n,N as d}from"./p-dd7ad463.js";import"./p-fcfa9e22.js";import{s as w}from"./p-1de51046.js";import{F as c}from"./p-d96f92e5.js";import"./p-144a434e.js";import"./p-72dc819a.js";import"./p-e71312f9.js";import"./p-4031f4ff.js";import"./p-37e9f5c1.js";const a=class{constructor(l){t(this,l),this.editChildActivity=s(this,"editChildActivity",7),this.childActivitySelected=s(this,"childActivitySelected",7),this.portElements=[],this.renderIcon=t=>{const i=this.displayTypeIsPicker?"tw-px-2":"tw-px-4";if(t)return e("div",{class:`${i} tw-py-1`},t())},this.renderPorts=(t,i)=>{if(!this.displayTypeIsPicker&&this.activityDescriptor&&0!=i.length)return e("div",{class:"activity-ports tw-mt-2 tw-flex tw-space-x-2"},i.map((e=>this.renderPort(t,e))))},this.renderPort=(t,i)=>{const s=1==(null==t?void 0:t.canStartWorkflow)?"tw-text-white":"tw-text-gray-600",r=i.name==this.selectedPortName?"tw-border-blue-600":"tw-border-gray-300",o=this.activityDescriptor,l=this.portProviderRegistry.get(o.typeName).resolvePort(i.name,{activity:t,activityDescriptor:o});return e("div",{class:"activity-port","data-port-name":i.name,ref:t=>this.portElements.push(t)},e("div",null,(()=>{if(!l)return e("div",{class:"tw-relative tw-block tw-w-full tw-border-2 tw-border-gray-300 tw-border-dashed tw-rounded-lg tw-p-3 tw-text-center focus:tw-outline-none"},e("a",{href:"#",onClick:e=>this.onEditChildActivityClick(e,t,i),onMouseDown:t=>t.stopPropagation(),class:"tw-text-gray-400 hover:tw-text-gray-600"},e("div",{class:"tw-flex-grow"},e("span",{class:`tw-text-sm ${s}`},i.displayName))));const o=Array.isArray(l);return e("div",o?{class:`tw-relative tw-block tw-w-full tw-border-2 ${r} tw-border-solid tw-rounded-lg tw-p-5 tw-text-center focus:tw-outline-none`}:{class:`tw-relative tw-block tw-w-full tw-border-2 ${r} tw-border-solid tw-rounded-lg tw-p-3 tw-text-center focus:tw-outline-none`},e("div",{class:"tw-flex tw-space-x-2"},e("a",{href:"#",onClick:e=>this.onEditChildActivityClick(e,t,i),onMouseDown:t=>t.stopPropagation()},e("div",{class:"tw-flex-grow"},e("span",{class:`tw-text-sm ${s}`},i.displayName)))))})()))},this.onEditChildActivityClick=(t,e,i)=>{t.preventDefault(),this.editChildActivity.emit({parentActivityId:e.id,port:i})},this.activityType=void 0,this.activityTypeVersion=1,this.displayType=void 0,this.activityId=void 0,this.selectedPortName=void 0,this.iconRegistry=i.get(o),this.portProviderRegistry=i.get(r)}componentWillLoad(){var t;const e=this.iconRegistry,i=this.activityType,s=null!==(t=this.activityTypeVersion)&&void 0!==t?t:0;this.activityDescriptor=w.activityDescriptors.find((t=>t.typeName==i&&t.version==s)),this.icon=e.has(i)?e.get(i):null}componentWillRender(){this.portElements=[]}render(){const t=this.activityDescriptor,i=this.activityId,s=this.portProviderRegistry.get(t.typeName);return e(c.Consumer,null,(({nodeMap:r})=>{var o,a,c,w,p,v;const y=r[i],h=s.getOutboundPorts({activityDescriptor:t,activity:y}).filter((t=>t.type==l.Embedded&&!1!==t.isBrowsable)),u=null!==(p=null!==(w=null!==(a=null===(o=null==y?void 0:y.customProperties)||void 0===o?void 0:o.canStartWorkflow)&&void 0!==a?a:null===(c=null==y?void 0:y.customProperties)||void 0===c?void 0:c.CanStartWorkflow)&&void 0!==w?w:null==y?void 0:y.canStartWorkflow)&&void 0!==p&&p,m=this.icon,f=!!m,g=u?"tw-text-white":"tw-text-gray-700",x=(null==t?void 0:t.kind)==d.Trigger,b=u?x?"tw-bg-green-400":"tw-bg-blue-400":"tw-bg-white",k=x?"tw-bg-green-500":"tw-bg-blue-500",P=u?x?"tw-border-green-600":"tw-border-blue-600":"tw-border-gray-300",C=this.displayTypeIsPicker,T=this.displayTypeIsEmbedded?"":"tw-drop-shadow-md",$=C?"tw-px-2 tw-py-2":"tw-px-4 tw-pt-0 tw-pb-3";let I=null===(v=null==y?void 0:y.metadata)||void 0===v?void 0:v.displayText;return n(I)&&(I=null==t?void 0:t.displayName),0==h.length||C?e("div",null,e("div",{class:`activity-wrapper tw-border ${P} ${b} ${T} tw-rounded tw-text-white tw-overflow-hidden`},e("div",{class:"elsa-toolbar-menu-wrapper tw-flex tw-flex-row"},e("div",{class:`tw-flex tw-flex-shrink tw-items-center ${k}`},this.renderIcon(m)),e("div",{class:"tw-flex tw-items-center"},e("div",{class:C?"tw-m-2":"tw-m-3"},e("span",{class:`${g}`},I),e("div",null,this.renderPorts(y,h))))))):e("div",null,e("div",{class:`activity-wrapper tw-border ${P} ${b} ${T} tw-rounded tw-overflow-hidden`},e("div",{class:"tw-text-white"},e("div",{class:`tw-flex tw-flex-shrink tw-items-center tw-py-3 ${f?"tw-pr-3":"tw-px-3"} ${k}`},this.renderIcon(m),e("span",null,I))),e("div",{class:"elsa-toolbar-menu-wrapper tw-flex tw-flex-col"},e("div",{class:"tw-flex tw-items-center"},e("div",{class:$},this.renderPorts(y,h))))))}))}get displayTypeIsPicker(){return"picker"==this.displayType}get displayTypeIsEmbedded(){return"embedded"==this.displayType}onWindowClicked(t){const e=t.target;for(const t of this.portElements)if(t.contains(e))return;this.selectedPortName=null}};export{a as elsa_default_activity_template};