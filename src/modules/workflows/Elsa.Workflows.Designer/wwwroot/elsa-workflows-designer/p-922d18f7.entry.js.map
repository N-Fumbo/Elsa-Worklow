{"version":3,"names":["ContextMenu","this","getAnchorPointClass","anchorPoint","ContextMenuAnchorPoint","BottomLeft","BottomRight","TopLeft","TopRight","renderMenuItemGroups","menuItemGroups","Object","keys","length","map","group","renderMenuItems","menuItems","hasAnyIcons","find","x","icon","h","class","menuItem","anchorUrl","isToggle","checked","href","onClick","e","onMenuItemClick","role","undefined","text","TickIcon","renderButton","hideButton","toggleMenu","type","xmlns","viewBox","fill","d","async","showContextMenu","closeContextMenu","onWindowClicked","event","target","element","contains","contextMenu","enter","leave","toggle","preventDefault","handler","render","anchorPointClass","groupBy","_a","ref","el"],"sources":["./src/components/shared/context-menu/context-menu.tsx"],"sourcesContent":["import {Component, h, Listen, Method, Prop, Element} from '@stencil/core';\nimport {leave, toggle, enter} from 'el-transition';\nimport {groupBy, map} from 'lodash';\nimport {ContextMenuAnchorPoint, ContextMenuItem} from \"./models\";\nimport {TickIcon} from \"../../icons/tooling/tick\";\n\n@Component({\n  tag: 'elsa-context-menu',\n  shadow: false,\n})\nexport class ContextMenu {\n  @Prop({mutable: true}) menuItems: Array<ContextMenuItem> = [];\n  @Prop() hideButton: boolean;\n  @Prop() anchorPoint: ContextMenuAnchorPoint;\n\n  contextMenu: HTMLElement;\n  @Element() element: HTMLElement;\n\n  @Method()\n  async open(): Promise<void> {\n    this.showContextMenu();\n  }\n\n  @Method()\n  async close(): Promise<void> {\n    this.closeContextMenu();\n  }\n\n  @Listen('click', {target: 'window'})\n  private onWindowClicked(event: Event) {\n    const target = event.target as HTMLElement;\n\n    if (!this.element.contains(target))\n      this.closeContextMenu();\n  }\n\n  private showContextMenu() {\n    if (!!this.contextMenu)\n      enter(this.contextMenu);\n  }\n\n  private closeContextMenu() {\n    if (!!this.contextMenu)\n      leave(this.contextMenu);\n  }\n\n  private toggleMenu() {\n    toggle(this.contextMenu);\n  }\n\n  private async onMenuItemClick(e: MouseEvent, menuItem: ContextMenuItem) {\n    e.preventDefault();\n\n    if (!!menuItem.handler)\n      menuItem.handler(e);\n\n    if (menuItem.isToggle) {\n      menuItem.checked = !menuItem.checked;\n      this.menuItems = [...this.menuItems]; // Trigger a re-render.\n    }\n\n    this.closeContextMenu();\n  }\n\n  private getAnchorPointClass = (): string => {\n    switch (this.anchorPoint) {\n      case ContextMenuAnchorPoint.BottomLeft:\n        return 'tw-origin-bottom-left tw-left-0';\n      case ContextMenuAnchorPoint.BottomRight:\n        return 'tw-origin-bottom-right tw-right-0';\n      case ContextMenuAnchorPoint.TopLeft:\n        return 'tw-origin-top-left tw-left-0';\n      case ContextMenuAnchorPoint.TopRight:\n      default:\n        return 'tw-origin-top-right tw-right-0'\n    }\n  };\n\n  render() {\n    const anchorPointClass = this.getAnchorPointClass();\n    const menuItems = this.menuItems;\n    const menuItemGroups:any = groupBy(menuItems, x => x.group ?? 0);\n\n    return (\n      <div class=\"tw-relative tw-flex tw-justify-end tw-items-center\">\n        {this.renderButton()}\n        <div ref={el => this.contextMenu = el}\n             data-transition-enter=\"tw-transition tw-ease-out tw-duration-100\"\n             data-transition-enter-start=\"tw-transform tw-opacity-0 tw-scale-95\"\n             data-transition-leave=\"tw-transition tw-ease-in tw-duration-75\"\n             data-transition-leave-start=\"tw-transform tw-opacity-100 tw-scale-100\"\n             data-transition-leave-end=\"tw-transform tw-opacity-0 tw-scale-95\"\n             class={`hidden tw-z-10 tw-mx-3 tw-absolute ${anchorPointClass} tw-w-48 tw-mt-1 tw-rounded-md tw-shadow-lg`}>\n          <div class=\"tw-rounded-md tw-bg-white tw-shadow-xs tw-ring-1 tw-ring-black tw-ring-opacity-5 tw-divide-y tw-divide-gray-100 focus:tw-outline-none\" role=\"menu\" aria-orientation=\"vertical\" aria-labelledby=\"project-options-menu-0\">\n            {this.renderMenuItemGroups(menuItemGroups)}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  renderMenuItemGroups = (menuItemGroups: Array<any>) => {\n    if (Object.keys(menuItemGroups).length == 0)\n      return;\n\n    return map(menuItemGroups, group => this.renderMenuItems(group));\n  }\n\n  renderMenuItems = (menuItems: Array<ContextMenuItem>) => {\n    if (menuItems.length == 0)\n      return;\n\n    const hasAnyIcons = menuItems.find(x => !!x.icon) != null;\n\n    return <div class=\"tw-py-1\">\n      {menuItems.map(menuItem => {\n        const anchorUrl = menuItem.anchorUrl || '#';\n        const isToggle = menuItem.isToggle;\n        const checked = menuItem.checked;\n        return (\n\n          <a href={anchorUrl}\n             onClick={e => this.onMenuItemClick(e, menuItem)}\n             class=\"tw-group tw-flex tw-items-center tw-px-4 tw-py-2 tw-text-sm tw-leading-5 tw-text-gray-700 hover:tw-bg-gray-100 hover:tw-text-gray-900 focus:tw-outline-none focus:tw-bg-gray-100 focus:tw-text-gray-900\"\n             role=\"menuitem\">\n            {menuItem.icon ? <span class=\"tw-mr-3\">{menuItem.icon}</span> : hasAnyIcons ? <span class=\"tw-mr-7\"/> : undefined}\n            <span class=\"tw-flex-grow\">{menuItem.text}</span>\n            {isToggle && checked ? <span class=\"tw-float-right\"><TickIcon/></span> : undefined}\n          </a>\n        );\n      })}\n    </div>\n  };\n\n  renderButton = () => {\n    if (this.hideButton)\n      return;\n\n    return <button onClick={() => this.toggleMenu()} aria-has-popup=\"true\" type=\"button\"\n                   class=\"tw-w-8 tw-h-8 tw-inline-flex tw-items-center tw-justify-center tw-text-gray-400 tw-rounded-full tw-bg-transparent hover:tw-text-gray-500 focus:tw-outline-none focus:tw-text-gray-500 focus:tw-bg-gray-100 tw-transition tw-ease-in-out tw-duration-150\">\n      <svg class=\"tw-w-5 tw-h-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n        <path d=\"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z\"/>\n      </svg>\n    </button>;\n  }\n}\n"],"mappings":"8OAUaA,EAAW,M,yBAsDdC,KAAAC,oBAAsB,KAC5B,OAAQD,KAAKE,aACX,KAAKC,EAAuBC,WAC1B,MAAO,kCACT,KAAKD,EAAuBE,YAC1B,MAAO,oCACT,KAAKF,EAAuBG,QAC1B,MAAO,+BACT,KAAKH,EAAuBI,SAC5B,QACE,MAAO,iC,EA2BbP,KAAAQ,qBAAwBC,IACtB,GAAIC,OAAOC,KAAKF,GAAgBG,QAAU,EACxC,OAEF,OAAOC,MAAIJ,GAAgBK,GAASd,KAAKe,gBAAgBD,IAAO,EAGlEd,KAAAe,gBAAmBC,IACjB,GAAIA,EAAUJ,QAAU,EACtB,OAEF,MAAMK,EAAcD,EAAUE,MAAKC,KAAOA,EAAEC,QAAS,KAErD,OAAOC,EAAA,OAAKC,MAAM,WACfN,EAAUH,KAAIU,IACb,MAAMC,EAAYD,EAASC,WAAa,IACxC,MAAMC,EAAWF,EAASE,SAC1B,MAAMC,EAAUH,EAASG,QACzB,OAEEL,EAAA,KAAGM,KAAMH,EACNI,QAASC,GAAK7B,KAAK8B,gBAAgBD,EAAGN,GACtCD,MAAM,0MACNS,KAAK,YACLR,EAASH,KAAOC,EAAA,QAAMC,MAAM,WAAWC,EAASH,MAAeH,EAAcI,EAAA,QAAMC,MAAM,YAAcU,UACxGX,EAAA,QAAMC,MAAM,gBAAgBC,EAASU,MACpCR,GAAYC,EAAUL,EAAA,QAAMC,MAAM,kBAAiBD,EAACa,EAAQ,OAAYF,UACvE,IAGJ,EAGRhC,KAAAmC,aAAe,KACb,GAAInC,KAAKoC,WACP,OAEF,OAAOf,EAAA,UAAQO,QAAS,IAAM5B,KAAKqC,aAAY,iBAAiB,OAAOC,KAAK,SAC7DhB,MAAM,2PACnBD,EAAA,OAAKC,MAAM,gBAAgBiB,MAAM,6BAA6BC,QAAQ,YAAYC,KAAK,gBACrFpB,EAAA,QAAMqB,EAAE,kGAEH,E,eApIgD,G,qDAQ3DC,aACE3C,KAAK4C,iB,CAIPD,cACE3C,KAAK6C,kB,CAICC,gBAAgBC,GACtB,MAAMC,EAASD,EAAMC,OAErB,IAAKhD,KAAKiD,QAAQC,SAASF,GACzBhD,KAAK6C,kB,CAGDD,kBACN,KAAM5C,KAAKmD,YACTC,EAAMpD,KAAKmD,Y,CAGPN,mBACN,KAAM7C,KAAKmD,YACTE,EAAMrD,KAAKmD,Y,CAGPd,aACNiB,EAAOtD,KAAKmD,Y,CAGNR,sBAAsBd,EAAeN,GAC3CM,EAAE0B,iBAEF,KAAMhC,EAASiC,QACbjC,EAASiC,QAAQ3B,GAEnB,GAAIN,EAASE,SAAU,CACrBF,EAASG,SAAWH,EAASG,QAC7B1B,KAAKgB,UAAY,IAAIhB,KAAKgB,U,CAG5BhB,KAAK6C,kB,CAiBPY,SACE,MAAMC,EAAmB1D,KAAKC,sBAC9B,MAAMe,EAAYhB,KAAKgB,UACvB,MAAMP,EAAqBkD,UAAQ3C,GAAWG,IAAC,IAAAyC,EAAI,OAAAA,EAAAzC,EAAEL,SAAK,MAAA8C,SAAA,EAAAA,EAAI,CAAC,IAE/D,OACEvC,EAAA,OAAKC,MAAM,sDACRtB,KAAKmC,eACNd,EAAA,OAAKwC,IAAKC,GAAM9D,KAAKmD,YAAcW,EAAE,wBACV,4CAA2C,8BACrC,wCAAuC,wBAC7C,0CAAyC,8BACnC,2CAA0C,4BAC5C,wCAC1BxC,MAAO,sCAAsCoC,gDAChDrC,EAAA,OAAKC,MAAM,wIAAwIS,KAAK,OAAM,mBAAkB,WAAU,kBAAiB,0BACxM/B,KAAKQ,qBAAqBC,K"}