{"version":3,"names":["LoginPage","constructor","hostRef","this","onSubmit","async","e","preventDefault","showError","window","requestAnimationFrame","form","target","formData","FormData","username","get","password","rememberMe","loginResponse","loginApi","login","isAuthenticated","signedIn","emit","accessToken","refreshToken","authContext","Container","AuthContext","signin","renderError","h","class","xmlns","viewBox","fill","d","LoginApi","render","action","method","htmlFor","id","name","type","autocomplete","required","autoComplete","value"],"sources":["./src/modules/login/components/login-page.tsx"],"sourcesContent":["import {Component, h, State, Event, EventEmitter} from \"@stencil/core\";\nimport {LoginApi} from \"../services\";\nimport {Container} from \"typedi\";\nimport {AuthContext} from \"../../../services\";\nimport {SignedInArgs} from \"../models\";\n\n@Component({\n  tag: 'elsa-login-page',\n  shadow: false\n})\nexport class LoginPage {\n\n  private loginApi: LoginApi;\n\n  @Event() signedIn: EventEmitter<SignedInArgs>;\n  @State() showError: boolean;\n\n  constructor() {\n    this.loginApi = Container.get(LoginApi);\n  }\n\n  private onSubmit = async (e: Event) => {\n    e.preventDefault();\n    this.showError = false;\n\n    window.requestAnimationFrame(() => {\n    });\n\n    const form: HTMLFormElement = e.target as HTMLFormElement;\n    const formData = new FormData(form);\n    const username = formData.get('username') as string;\n    const password = formData.get('password') as string;\n    const rememberMe = formData.get('remember-me') as string == 'true';\n    const loginResponse = await this.loginApi.login(username, password);\n\n    if (!loginResponse.isAuthenticated) {\n      this.showError = true;\n    }\n\n    this.signedIn.emit();\n\n    const accessToken = loginResponse.accessToken;\n    const refreshToken = loginResponse.refreshToken;\n    const authContext = Container.get(AuthContext);\n    await authContext.signin(accessToken, refreshToken, rememberMe);\n  }\n\n  private renderError = () => {\n    if (!this.showError)\n      return;\n\n    return <div class=\"tw-rounded-md tw-bg-red-50 tw-p-4\">\n      <div class=\"tw-flex\">\n        <div class=\"tw-flex-shrink-0\">\n          <svg class=\"tw-h-5 tw-w-5 tw-text-red-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\">\n            <path fill-rule=\"evenodd\"\n                  d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z\"\n                  clip-rule=\"evenodd\"/>\n          </svg>\n        </div>\n        <div class=\"tw-ml-3\">\n          <h3 class=\"tw-text-sm tw-font-medium tw-text-red-800\">Invalid credentials</h3>\n          <div class=\"tw-mt-2 tw-text-sm tw-text-red-700\">\n            The provided credentials were invalid. Please try again.\n          </div>\n        </div>\n      </div>\n    </div>\n  }\n\n  render() {\n    return <div>\n      <div class=\"tw-flex min-tw-h-full tw-flex-col tw-pt-20 tw-bg-gray-800 tw-h-screen\">\n\n        <div class=\"tw-mt-8 sm:tw-mx-auto sm:tw-w-full sm:tw-max-w-md\">\n          <div class=\"tw-bg-white tw-py-8 tw-px-4 tw-shadow sm:tw-rounded-lg sm:tw-px-10\">\n\n            {this.renderError()}\n\n            <form class=\"tw-mt-4 tw-space-y-6\" action=\"#\" method=\"POST\" onSubmit={this.onSubmit}>\n              <div>\n                <label htmlFor=\"username\" class=\"tw-block tw-text-sm tw-font-medium tw-text-gray-700\">Username</label>\n                <div class=\"tw-mt-1\">\n                  <input id=\"username\" name=\"username\" type=\"text\" autocomplete=\"off\" required\n                         class=\"tw-block tw-w-full tw-appearance-none tw-rounded-md tw-border tw-border-gray-300 tw-px-3 tw-py-2 tw-placeholder-gray-400 tw-shadow-sm focus:tw-border-blue-500 focus:tw-outline-none focus:tw-ring-blue-500 sm:tw-text-sm\"/>\n                </div>\n              </div>\n\n              <div>\n                <label htmlFor=\"password\" class=\"tw-block tw-text-sm tw-font-medium tw-text-gray-700\">Password</label>\n                <div class=\"tw-mt-1\">\n                  <input id=\"password\" name=\"password\" type=\"password\" autoComplete=\"current-password\" required\n                         class=\"tw-block tw-w-full tw-appearance-none tw-rounded-md tw-border tw-border-gray-300 tw-px-3 tw-py-2 tw-placeholder-gray-400 tw-shadow-sm focus:tw-border-blue-500 focus:tw-outline-none focus:tw-ring-blue-500 sm:tw-text-sm\"/>\n                </div>\n              </div>\n\n              <div class=\"tw-flex tw-items-center tw-justify-between\">\n                <div class=\"tw-flex tw-items-center\">\n                  <input id=\"remember-me\" name=\"remember-me\" type=\"checkbox\" value=\"true\" class=\"tw-h-4 tw-w-4 tw-rounded tw-border-gray-300 tw-text-blue-600 focus:tw-ring-blue-500\"/>\n                  <label htmlFor=\"remember-me\" class=\"tw-ml-2 tw-block tw-text-sm tw-text-gray-900\">Remember me</label>\n                </div>\n              </div>\n\n              <div>\n                <button type=\"submit\"\n                        class=\"tw-flex tw-w-full tw-justify-center tw-rounded-md tw-border tw-border-transparent tw-bg-blue-600 tw-py-2 tw-px-4 tw-text-sm tw-font-medium tw-text-white tw-shadow-sm hover:tw-bg-blue-700 focus:tw-outline-none focus:tw-ring-2 focus:tw-ring-blue-500 focus:tw-ring-offset-2\">Sign in\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>;\n  }\n}\n"],"mappings":"0PAUaA,EAAS,MAOpBC,YAAAC,G,6CAIQC,KAAAC,SAAWC,MAAOC,IACxBA,EAAEC,iBACFJ,KAAKK,UAAY,MAEjBC,OAAOC,uBAAsB,SAG7B,MAAMC,EAAwBL,EAAEM,OAChC,MAAMC,EAAW,IAAIC,SAASH,GAC9B,MAAMI,EAAWF,EAASG,IAAI,YAC9B,MAAMC,EAAWJ,EAASG,IAAI,YAC9B,MAAME,EAAaL,EAASG,IAAI,gBAA4B,OAC5D,MAAMG,QAAsBhB,KAAKiB,SAASC,MAAMN,EAAUE,GAE1D,IAAKE,EAAcG,gBAAiB,CAClCnB,KAAKK,UAAY,I,CAGnBL,KAAKoB,SAASC,OAEd,MAAMC,EAAcN,EAAcM,YAClC,MAAMC,EAAeP,EAAcO,aACnC,MAAMC,EAAcC,EAAUZ,IAAIa,SAC5BF,EAAYG,OAAOL,EAAaC,EAAcR,EAAW,EAGzDf,KAAA4B,YAAc,KACpB,IAAK5B,KAAKK,UACR,OAEF,OAAOwB,EAAA,OAAKC,MAAM,qCAChBD,EAAA,OAAKC,MAAM,WACTD,EAAA,OAAKC,MAAM,oBACTD,EAAA,OAAKC,MAAM,gCAAgCC,MAAM,6BAA6BC,QAAQ,YAAYC,KAAK,eAAc,cAAa,QAChIJ,EAAA,oBAAgB,UACVK,EAAE,gNAA+M,YACvM,cAGpBL,EAAA,OAAKC,MAAM,WACTD,EAAA,MAAIC,MAAM,6CAA2C,uBACrDD,EAAA,OAAKC,MAAM,sCAAoC,8DAK/C,E,yBAjDN9B,KAAKiB,SAAWQ,EAAUZ,IAAIsB,E,CAoDhCC,SACE,OAAOP,EAAA,WACLA,EAAA,OAAKC,MAAM,yEAETD,EAAA,OAAKC,MAAM,qDACTD,EAAA,OAAKC,MAAM,sEAER9B,KAAK4B,cAENC,EAAA,QAAMC,MAAM,uBAAuBO,OAAO,IAAIC,OAAO,OAAOrC,SAAUD,KAAKC,UACzE4B,EAAA,WACEA,EAAA,SAAOU,QAAQ,WAAWT,MAAM,uDAAqD,YACrFD,EAAA,OAAKC,MAAM,WACTD,EAAA,SAAOW,GAAG,WAAWC,KAAK,WAAWC,KAAK,OAAOC,aAAa,MAAMC,SAAQ,KACrEd,MAAM,gOAIjBD,EAAA,WACEA,EAAA,SAAOU,QAAQ,WAAWT,MAAM,uDAAqD,YACrFD,EAAA,OAAKC,MAAM,WACTD,EAAA,SAAOW,GAAG,WAAWC,KAAK,WAAWC,KAAK,WAAWG,aAAa,mBAAmBD,SAAQ,KACtFd,MAAM,gOAIjBD,EAAA,OAAKC,MAAM,8CACTD,EAAA,OAAKC,MAAM,2BACTD,EAAA,SAAOW,GAAG,cAAcC,KAAK,cAAcC,KAAK,WAAWI,MAAM,OAAOhB,MAAM,wFAC9ED,EAAA,SAAOU,QAAQ,cAAcT,MAAM,gDAA8C,iBAIrFD,EAAA,WACEA,EAAA,UAAQa,KAAK,SACLZ,MAAM,kRAAgR,gB"}