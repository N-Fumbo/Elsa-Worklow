import{h as t,r as e,c as i}from"./p-a7a3baa1.js";import{l as s}from"./p-e71312f9.js";import{s as n}from"./p-1de51046.js";import{F as a,C as l}from"./p-93025d0a.js";import{o,u as r,C as u,ac as h,a4 as c,aa as d,a3 as p,ab as m,B as w,Y as b}from"./p-dd7ad463.js";import"./p-fcfa9e22.js";import{E as v,D as y}from"./p-435023bb.js";import{h as f}from"./p-4031f4ff.js";import"./p-72dc819a.js";import"./p-144a434e.js";import"./p-ec4413cd.js";const g=()=>t("svg",{class:"tw-h-6 tw-w-6 tw-text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},t("path",{stroke:"none",d:"M0 0h24v24H0z"}),t("path",{d:"M9 11l-4 4l4 4m-4 -4h11a4 4 0 0 0 0 -8h-1"})),x=()=>t("svg",{class:"tw-h-6 tw-w-6 tw-text-blue-500",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})),k=class{constructor(t){e(this,t),this.inputChanged=i(this,"inputChanged",7),this.onSubmit=async t=>{t.preventDefault();const e=t.target,i=this.getInputInternal(e);this.inputChanged.emit(i)},this.getInputInternal=t=>{const e=new FormData(t),i=e.get("inputName"),a=e.get("inputDisplayName"),n=e.get("inputTypeName"),s=e.get("inputDescription"),l=e.get("inputCategory"),r=e.get("inputUIHint"),u="true"===e.get("inputIsArray"),p=e.get("inputStorageDriverType"),d=this.input;return d.name=i,d.type=n,d.displayName=a,d.category=l,d.description=s,d.uiHint=r,d.isArray=u,d.storageDriverType=o(p)?null:p,d},this.input=void 0}async getInput(){return this.getInputInternal(this.formElement)}render(){var e;const i=null!==(e=this.input)&&void 0!==e?e:{name:"",type:"Object",isArray:!1},o=i.type,r=n.variableDescriptors,u=n.storageDrivers,p=s.groupBy(r,(t=>t.category)),d=i.uiHint;return t("div",null,t("form",{ref:t=>this.formElement=t,class:"tw-h-full tw-flex tw-flex-col tw-bg-white",onSubmit:t=>this.onSubmit(t),method:"post"},t("div",{class:"tw-pt-4"},t("h2",{class:"tw-text-lg tw-font-medium tw-ml-4 tw-mb-2"},"Edit input definition"),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t(a,{fieldId:"inputName",label:"Name",hint:"The technical name of the input."},t("input",{type:"text",name:"inputName",id:"inputName",value:i.name})),t(a,{fieldId:"inputTypeName",label:"Type",hint:"The type of the input."},t("select",{id:"inputTypeName",name:"inputTypeName"},Object.keys(p).map((e=>{const i=p[e];return t("optgroup",{label:e},i.map((e=>t("option",{value:e.typeName,selected:e.typeName==o},e.displayName))))})))),t(l,{fieldId:"inputIsArray",label:"This input is an array",hint:"Check if the input holds an array of the selected type."},t("input",{type:"checkbox",name:"inputIsArray",id:"inputIsArray",value:"true",checked:i.isArray})),t(a,{fieldId:"inputDisplayName",label:"Display name",hint:"The user friendly display name of the input."},t("input",{type:"text",name:"inputDisplayName",id:"inputDisplayName",value:i.displayName})),t(a,{fieldId:"inputDescription",label:"Description",hint:"A description of the input."},t("input",{type:"text",name:"inputDescription",id:"inputDescription",value:i.description})),t(a,{fieldId:"inputCategory",label:"Category",hint:"A custom category."},t("input",{type:"text",name:"inputCategory",id:"inputCategory",value:i.category})),t(a,{fieldId:"inputUIHint",label:"Control",hint:"The control to use for this input."},t("select",{name:"inputUIHint",id:"inputUIHint"},[{name:"Single line",value:"single-line"},{name:"Multi line",value:"multi-line"},{name:"Checkbox",value:"checkbox"},{name:"Check list",value:"check-list"},{name:"Radio list",value:"radio-list"},{name:"Dropdown",value:"dropdown"},{name:"Multi text",value:"multi-text"},{name:"Code editor",value:"code-editor"},{name:"Variable picker",value:"variable-picker"},{name:"Type picker",value:"type-picker"}].map((e=>{const i=e.value==d;return t("option",{value:e.value,selected:i},e.name)})))),t(a,{fieldId:"inputStorageDriverType",label:"Storage",hint:"The storage to use when persisting the input."},t("select",{id:"inputStorageDriverType",name:"inputStorageDriverType"},u.map((e=>{const a=e.typeName,n=e.displayName,s=a==i.storageDriverType;return t("option",{value:a,selected:s},n)}))))))))}},N=class{constructor(t){e(this,t),this.outputChanged=i(this,"outputChanged",7),this.onSubmit=async t=>{t.preventDefault();const e=t.target,i=this.getOutputInternal(e);this.outputChanged.emit(i)},this.getOutputInternal=t=>{const e=new FormData(t),i=e.get("outputName"),a=e.get("outputDisplayName"),n=e.get("outputTypeName"),s=e.get("outputDescription"),l=this.output;return l.name=i,l.type=n,l.displayName=a,l.description=s,l},this.output=void 0}async getOutput(){return this.getOutputInternal(this.formElement)}render(){var e;const i=null!==(e=this.output)&&void 0!==e?e:{name:"",type:"Object",isArray:!1},l=i.type,o=n.variableDescriptors,r=s.groupBy(o,(t=>t.category));return t("div",null,t("form",{ref:t=>this.formElement=t,class:"tw-h-full tw-flex tw-flex-col tw-bg-white",onSubmit:t=>this.onSubmit(t),method:"post"},t("div",{class:"tw-pt-4"},t("h2",{class:"tw-text-lg tw-font-medium tw-ml-4 tw-mb-2"},"Edit output definition"),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t(a,{fieldId:"outputName",label:"Name",hint:"The technical name of the output."},t("input",{type:"text",name:"outputName",id:"outputName",value:i.name})),t(a,{fieldId:"outputTypeName",label:"Type",hint:"The type of the output."},t("select",{id:"outputTypeName",name:"outputTypeName"},Object.keys(r).map((e=>{const i=r[e];return t("optgroup",{label:e},i.map((e=>t("option",{value:e.typeName,selected:e.typeName==l},e.displayName))))})))),t(a,{fieldId:"outputDisplayName",label:"Display name",hint:"The user friendly display name of the output."},t("input",{type:"text",name:"outputDisplayName",id:"outputDisplayName",value:i.displayName})),t(a,{fieldId:"outputDescription",label:"Description",hint:"A description of the output."},t("input",{type:"text",name:"outputDescription",id:"outputDescription",value:i.description}))))))}},T=class{constructor(t){e(this,t),this.variableChanged=i(this,"variableChanged",7),this.onSubmit=async t=>{t.preventDefault();const e=t.target,i=this.getVariableInternal(e);this.variableChanged.emit(i)},this.getVariableInternal=t=>{const e=new FormData(t),i=e.get("variableName"),a=e.get("variableValue"),n=e.get("variableTypeName"),s="true"==e.get("variableIsArray"),l=e.get("variableStorageDriverTypeName"),u=this.variable;return o(u.id)&&(u.id=r()),u.name=i,u.typeName=n,u.value=a,u.isArray=s,u.storageDriverTypeName=o(l)?null:l,u},this.variable=void 0}async getVariable(){return this.getVariableInternal(this.formElement)}render(){var e;const i=null!==(e=this.variable)&&void 0!==e?e:{id:"",name:"",typeName:"Object",isArray:!1},o=i.typeName,r=n.variableDescriptors,u=s.groupBy(r,(t=>t.category)),p=n.storageDrivers;return t("div",null,t("form",{ref:t=>this.formElement=t,class:"tw-h-full tw-flex tw-flex-col tw-bg-white",onSubmit:t=>this.onSubmit(t),method:"post"},t("div",{class:"tw-pt-4"},t("h2",{class:"tw-text-lg tw-font-medium tw-ml-4 tw-mb-2"},"Edit Variable"),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t(a,{fieldId:"variableName",label:"Name",hint:"The technical name of the variable."},t("input",{type:"text",name:"variableName",id:"variableName",value:i.name})),t(a,{fieldId:"variableTypeName",label:"Type",hint:"The type of the variable."},t("select",{id:"variableTypeName",name:"variableTypeName"},Object.keys(u).map((e=>{const i=u[e];return t("optgroup",{label:e},i.map((e=>t("option",{value:e.typeName,selected:e.typeName==o},e.displayName))))})))),t(l,{fieldId:"variableIsArray",label:"This variable is an array",hint:"Check if the variable holds an array of the selected type."},t("input",{type:"checkbox",name:"variableIsArray",id:"variableIsArray",value:"true",checked:i.isArray})),t(a,{fieldId:"variableValue",label:"Value",hint:"The value of the variable."},t("input",{type:"text",name:"variableValue",id:"variableValue",value:i.value})),t(a,{fieldId:"variableStorageDriverId",label:"Storage",hint:"The storage to use when persisting the variable."},t("select",{id:"variableStorageDriverTypeName",name:"variableStorageDriverTypeName"},p.map((e=>{const a=e.typeName,n=e.displayName,s=a==i.storageDriverTypeName;return t("option",{value:a,selected:s},n)}))))))))}},D=class{constructor(a){e(this,a),this.variablesChanged=i(this,"variablesChanged",7),this.getVariableNameExists=t=>!!this.variables.find((e=>e.name==t)),this.updateVariablesState=t=>{this.variablesState=t,this.variablesChanged.emit(t)},this.generateNewVariableName=()=>{let t=this.variables.length;for(;;){const e="Variable"+ ++t;if(!this.getVariableNameExists(e))return e}},this.onAddVariableClick=async()=>{const e={id:"",name:this.generateNewVariableName(),typeName:"Object",value:null,isArray:!1};this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-variable-editor-dialog-content",{variable:e})),{actions:[this.saveAction]})},this.onEditClick=async(e,i)=>{e.preventDefault(),this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-variable-editor-dialog-content",{variable:i})),{actions:[this.saveAction]})},this.onDeleteClick=(t,e)=>{t.preventDefault();const i=this.variables.filter((t=>t!=e));this.updateVariablesState(i)},this.onVariableChanged=async t=>{const e=await t.instance.modalDialogContentRef.getVariable();let i=this.variables;const a=!!i.find((t=>t==e));i=a?[...i]:[...i,e],i=i.sort(((t,e)=>t.name<e.name?-1:t.name>e.name?1:0)),this.updateVariablesState(i)},this.variables=void 0,this.variablesState=[],this.modalDialogService=u.get(h),this.saveAction={name:"Save",type:c.Submit,text:"Save",isPrimary:!0,onClick:this.onVariableChanged}}onVariablesPropChanged(t){this.variablesState=this.variables?[...this.variables]:[]}componentWillLoad(){this.onVariablesPropChanged(this.variables)}render(){const e=this.variables,i=n.storageDrivers;return t("div",null,t("div",{class:"tw-flex tw-justify-end tw-m-4"},t("button",{class:"elsa-btn elsa-btn-primary",onClick:t=>this.onAddVariableClick()},"Add variable")),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t("table",{class:"default-table"},t("thead",null,t("tr",null,t("th",{scope:"col"},"Name"),t("th",{scope:"col"},"Type"),t("th",{scope:"col"},"Storage"),t("th",{scope:"col"}))),t("tbody",null,e.map((e=>{var a,s;const l=i.find((t=>t.typeName==e.storageDriverTypeName)),o=null!==(a=null==l?void 0:l.displayName)&&void 0!==a?a:"-",r=n.variableDescriptors.find((t=>t.typeName==e.typeName)),u=null!==(s=null==r?void 0:r.displayName)&&void 0!==s?s:e.typeName;return t("tr",null,t("td",{class:"tw-whitespace-nowrap"},e.name),t("td",{class:"tw-whitespace-nowrap"},u),t("td",null,o),t("td",{class:"tw-pr-6"},t("elsa-context-menu",{menuItems:[{text:"Edit",handler:t=>this.onEditClick(t,e),icon:t(v,null)},{text:"Delete",handler:t=>this.onDeleteClick(t,e),icon:t(y,null)}]})))}))))))}static get watchers(){return{variables:["onVariablesPropChanged"]}}},I=class{constructor(t){e(this,t),this.widgets=[]}render(){const e=this.widgets.sort(((t,e)=>t.order<e.order?-1:t.order>e.order?1:0));return t("div",null,e.map((t=>t.content())))}},C=class{constructor(s){e(this,s),this.inputsChanged=i(this,"inputsChanged",7),this.outputsChanged=i(this,"outputsChanged",7),this.outcomesChanged=i(this,"outcomesChanged",7),this.renderInputs=()=>{const e=this.inputsState;return t("div",null,t("div",{class:"tw-p-4"},t("h3",{class:"tw-text-base tw-leading-6 tw-font-medium tw-text-gray-900"},"Inputs")),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t("table",{class:"default-table"},t("thead",null,t("tr",null,t("th",{scope:"col"},"Name"),t("th",{scope:"col"},"Type"),t("th",{scope:"col"}))),t("tbody",null,e.map((e=>{var i;const a=n.variableDescriptors.find((t=>t.typeName==e.type)),s=null!==(i=null==a?void 0:a.displayName)&&void 0!==i?i:e.type;return t("tr",null,t("td",{class:"tw-whitespace-nowrap"},e.name),t("td",{class:"tw-whitespace-nowrap"},s),t("td",{class:"tw-pr-6"},t("elsa-context-menu",{menuItems:[{text:"Edit",handler:t=>this.onEditInputClick(t,e),icon:t(v,null)},{text:"Delete",handler:t=>this.onDeleteInputClick(t,e),icon:t(y,null)}]})))}))))),t("div",{class:"tw-flex tw-justify-end tw-m-4"},t("button",{class:"elsa-btn elsa-btn-primary",onClick:t=>this.onAddInputClick()},"Add input parameter")))},this.renderOutputs=()=>{const e=this.outputsState;return t("div",null,t("div",{class:"tw-p-4"},t("h3",{class:"tw-text-base tw-leading-6 tw-font-medium tw-text-gray-900"},"Outputs")),t("div",{class:"tw-align-middle tw-inline-block tw-min-w-full tw-border-b tw-border-gray-200"},t("table",{class:"default-table"},t("thead",null,t("tr",null,t("th",{scope:"col"},"Name"),t("th",{scope:"col"},"Type"),t("th",{scope:"col"}))),t("tbody",null,e.map((e=>{var i;const a=n.variableDescriptors.find((t=>t.typeName==e.type)),s=null!==(i=null==a?void 0:a.displayName)&&void 0!==i?i:e.type;return t("tr",null,t("td",{class:"tw-whitespace-nowrap"},e.name),t("td",{class:"tw-whitespace-nowrap"},s),t("td",{class:"tw-pr-6"},t("elsa-context-menu",{menuItems:[{text:"Edit",handler:t=>this.onEditOutputClick(t,e),icon:t(v,null)},{text:"Delete",handler:t=>this.onDeleteOutputClick(t,e),icon:t(y,null)}]})))}))))),t("div",{class:"tw-flex tw-justify-end tw-m-4"},t("button",{class:"elsa-btn elsa-btn-primary",onClick:t=>this.onAddOutputClick()},"Add output parameter")))},this.renderOutcomes=()=>{const e=[...this.outcomes];return t("div",null,t("div",{class:"tw-p-4"},t("h3",{class:"tw-text-base tw-leading-6 tw-font-medium tw-text-gray-900"},"Outcomes")),t(a,{label:"",fieldId:"WorkflowDefinitionOutcomes",hint:"Enter a list of possible outcomes for this workflow."},t("elsa-input-tags",{placeHolder:"Add outcome",values:e,onValueChanged:t=>this.onOutcomesChanged(t.detail)})))},this.getInputNameExists=t=>!!this.inputsState.find((e=>e.name==t)),this.getOutputNameExists=t=>!!this.outputsState.find((e=>e.name==t)),this.updateInputsState=t=>{this.inputsState=t,this.inputsChanged.emit(t)},this.updateOutputsState=t=>{this.outputsState=t,this.outputsChanged.emit(t)},this.generateNewInputName=()=>{let t=this.inputsState.length;for(;;){const e="Input"+ ++t;if(!this.getInputNameExists(e))return e}},this.generateNewOutputName=()=>{let t=this.outputsState.length;for(;;){const e="Output"+ ++t;if(!this.getOutputNameExists(e))return e}},this.onAddInputClick=async()=>{const e=this.generateNewInputName(),i={name:e,type:"Object",displayName:e,isArray:!1};this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-activity-input-editor-dialog-content",{input:i})),{actions:[this.inputSaveAction]})},this.onAddOutputClick=async()=>{const e=this.generateNewOutputName(),i={name:e,type:"Object",displayName:e,isArray:!1};this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-activity-output-editor-dialog-content",{output:i})),{actions:[this.outputSaveAction]})},this.onEditInputClick=async(e,i)=>{e.preventDefault(),this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-activity-input-editor-dialog-content",{input:i})),{actions:[this.inputSaveAction]})},this.onEditOutputClick=async(e,i)=>{e.preventDefault(),this.modalDialogInstance=this.modalDialogService.show((()=>t("elsa-activity-output-editor-dialog-content",{output:i})),{actions:[this.outputSaveAction]})},this.onDeleteInputClick=(t,e)=>{t.preventDefault();const i=this.inputsState.filter((t=>t!=e));this.updateInputsState(i)},this.onDeleteOutputClick=(t,e)=>{t.preventDefault();const i=this.outputsState.filter((t=>t!=e));this.updateOutputsState(i)},this.onInputDefinitionChanged=async t=>{const e=await t.instance.modalDialogContentRef.getInput();let i=this.inputsState;const a=!!i.find((t=>t==e));i=a?[...i]:[...i,e],i=i.sort(((t,e)=>t.name<e.name?-1:t.name>e.name?1:0)),this.updateInputsState(i)},this.onOutputDefinitionChanged=async t=>{const e=await t.instance.modalDialogContentRef.getOutput();let i=this.outputsState;const a=!!i.find((t=>t==e));i=a?[...i]:[...i,e],i=i.sort(((t,e)=>t.name<e.name?-1:t.name>e.name?1:0)),this.updateOutputsState(i)},this.onOutcomesChanged=t=>{this.outcomesChanged.emit(t)},this.inputs=void 0,this.outputs=void 0,this.outcomes=void 0,this.inputsState=[],this.outputsState=[],this.modalDialogService=u.get(h),this.inputSaveAction={name:"Save",type:c.Submit,text:"Save",isPrimary:!0,onClick:this.onInputDefinitionChanged},this.outputSaveAction={name:"Save",type:c.Submit,text:"Save",isPrimary:!0,onClick:this.onOutputDefinitionChanged}}onInputsPropChanged(t){this.inputsState=this.inputs?[...this.inputs]:[]}onOutputsPropChanged(t){this.outputsState=this.outputs?[...this.outputs]:[]}componentWillLoad(){this.onInputsPropChanged(this.inputs),this.onOutputsPropChanged(this.outputs)}render(){return t("div",null,this.renderInputs(),this.renderOutputs(),this.renderOutcomes())}static get watchers(){return{inputs:["onInputsPropChanged"],outputs:["onOutputsPropChanged"]}}},j=class{constructor(t){e(this,t),this.versionSelected=i(this,"versionSelected",7),this.deleteVersionClicked=i(this,"deleteVersionClicked",7),this.revertVersionClicked=i(this,"revertVersionClicked",7),this.onViewVersionClick=(t,e)=>{t.preventDefault(),this.versionSelected.emit(e)},this.onDeleteVersionClick=async(t,e)=>{t.preventDefault(),this.modalDialogService.show((()=>d.Warning("Are you sure you want to delete this version?")),{modalType:p.Confirmation,actions:[m.Delete((()=>this.deleteVersionClicked.emit(e))),m.Cancel()]})},this.onRevertVersionClick=(t,e)=>{t.preventDefault(),this.revertVersionClicked.emit(e)},this.selectedVersion=void 0,this.workflowVersions=void 0,this.serverUrl=void 0,this.eventBus=u.get(w),this.workflowDefinitionApi=u.get(b),this.modalDialogService=u.get(h)}render(){return t("div",null,t("table",null,t("thead",null,t("tr",null,t("th",null),t("th",null,"Version"),t("th",null,"Created"),t("th",null),t("th",null))),t("tbody",null,this.workflowVersions.map((e=>{let i=[];return i.push({text:"Delete",handler:t=>this.onDeleteVersionClick(t,e),icon:t(y,null)}),e.isLatest||i.push({text:"Revert",handler:t=>this.onRevertVersionClick(t,e),icon:t(g,null)}),t("tr",null,t("td",null,e.isPublished?t(x,null):""),t("td",null,e.version),t("td",null,f(e.createdAt).format("DD-MM-YYYY HH:mm:ss")),t("td",null,t("button",{onClick:t=>this.onViewVersionClick(t,e),type:"button",disabled:this.selectedVersion.version==e.version,class:this.selectedVersion.version==e.version?"elsa-btn elsa-btn-primary":"elsa-btn elsa-btn-secondary"},"View")),t("td",null,e.isPublished||e.isPublished?void 0:t("elsa-context-menu",{menuItems:i})))})))))}};export{k as elsa_activity_input_editor_dialog_content,N as elsa_activity_output_editor_dialog_content,T as elsa_variable_editor_dialog_content,D as elsa_variables_editor,I as elsa_widgets,C as elsa_workflow_definition_input_output_settings,j as elsa_workflow_definition_version_history};