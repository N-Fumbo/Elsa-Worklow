{"version":3,"names":["SwitchEditor","this","supportedSyntaxes","SyntaxNames","JavaScript","Literal","updateActivity","inputContext","activity","inputDescriptor","propertyName","name","camelCasePropertyName","camelCase","cases","notifyInputChanged","onInputContextChanged","value","updateCases","componentWillLoad","onAddCaseClick","caseName","length","newCase","label","condition","type","onDeleteCaseClick","switchCase","filter","x","onCaseLabelChanged","e","currentTarget","trim","onCaseExpressionChanged","detail","onCaseSyntaxChanged","select","syntax","Object","assign","render","displayName","h","class","map","index","expression","language","mapSyntaxToLanguage","key","onChange","singleLineMode","editorHeight","padding","onValueChanged","supportedSyntax","selected","onClick","TrashBinButtonIcon","PlusButtonIcon"],"sources":["./src/modules/switch/sequence/switch-editor.tsx"],"sourcesContent":["import {Component, h, Prop, State, Watch} from \"@stencil/core\";\nimport {camelCase} from 'lodash';\nimport {ActivityInputContext} from \"../../../services/activity-input-driver\";\nimport {mapSyntaxToLanguage} from \"../../../utils\";\nimport {SyntaxNames} from \"../../../models\";\nimport {SwitchCase} from \"./models\";\nimport {MonacoValueChangedArgs} from \"../../../components/shared/monaco-editor/monaco-editor\";\nimport {TrashBinButtonIcon} from \"../../../components/icons/buttons/trash-bin\";\nimport {PlusButtonIcon} from \"../../../components/icons/buttons/plus\";\n\n@Component({\n  tag: 'elsa-switch-editor',\n  shadow: false\n})\nexport class SwitchEditor {\n  @Prop() inputContext: ActivityInputContext;\n  @State() private cases: Array<SwitchCase> = [];\n  private supportedSyntaxes: Array<string> = [SyntaxNames.JavaScript, SyntaxNames.Literal];\n\n  @Watch('inputContext')\n  onInputContextChanged(value: ActivityInputContext){\n    this.updateCases();\n  }\n\n  componentWillLoad() {\n    this.updateCases();\n  }\n\n  private updateCases(){\n    const inputContext = this.inputContext;\n    const activity = this.inputContext.activity;\n    const inputDescriptor = inputContext.inputDescriptor;\n    const propertyName = inputDescriptor.name;\n    const camelCasePropertyName = camelCase(propertyName);\n    this.cases = activity[camelCasePropertyName] || [];\n  }\n\n  private onAddCaseClick() {\n    const caseName = `Case ${this.cases.length + 1}`;\n    const newCase: SwitchCase = {label: caseName, condition: {type: SyntaxNames.JavaScript, value: ''}};\n    this.cases = [...this.cases, newCase];\n    this.updateActivity();\n  }\n\n  private onDeleteCaseClick(switchCase: SwitchCase) {\n    this.cases = this.cases.filter(x => x != switchCase);\n    this.updateActivity();\n  }\n\n  private onCaseLabelChanged(e: Event, switchCase: SwitchCase) {\n    switchCase.label = (e.currentTarget as HTMLInputElement).value.trim();\n    this.updateActivity();\n  }\n\n  private onCaseExpressionChanged(e: CustomEvent<MonacoValueChangedArgs>, switchCase: SwitchCase) {\n    switchCase.condition = {type: switchCase.condition.type, value: e.detail.value};\n    this.updateActivity();\n  }\n\n  private onCaseSyntaxChanged(e: Event, switchCase: SwitchCase) {\n    const select = e.currentTarget as HTMLSelectElement;\n    const syntax = select.value;\n    switchCase.condition = {...switchCase.condition, type: syntax};\n    this.cases = [...this.cases];\n    this.updateActivity();\n  }\n\n  private updateActivity = () => {\n    const inputContext = this.inputContext;\n    const activity = this.inputContext.activity;\n    const inputDescriptor = inputContext.inputDescriptor;\n    const propertyName = inputDescriptor.name;\n    const camelCasePropertyName = camelCase(propertyName);\n\n    activity[camelCasePropertyName] = this.cases;\n    this.inputContext.notifyInputChanged();\n  };\n\n  render() {\n    const inputContext = this.inputContext;\n    const inputDescriptor = inputContext.inputDescriptor;\n    const displayName = inputDescriptor.displayName;\n    const cases = this.cases;\n    const supportedSyntaxes = this.supportedSyntaxes;\n\n    return (\n      <div>\n        <div class=\"tw-p-4\">\n          <label>{displayName}</label>\n        </div>\n        <table class=\"tw-mt-1\">\n          <thead>\n          <tr>\n            <th class=\"tw-w-3/12\">Name</th>\n            <th class=\"tw-w-8/12\">Expression</th>\n            <th class=\"tw-w-1/12\">&nbsp;</th>\n          </tr>\n          </thead>\n          <tbody>\n          {cases.map((switchCase, index) => {\n            const condition = switchCase.condition;\n            const expression = condition.value;\n            const syntax = condition.type;\n            const language = mapSyntaxToLanguage(condition.type);\n\n            return (\n              <tr key={`case-${index}`}>\n                <td class=\"tw-py-2 tw-pr-5\">\n                  <input type=\"text\" value={switchCase.label} onChange={e => this.onCaseLabelChanged(e, switchCase)}/>\n                </td>\n                <td class=\"tw-py-2 tw-pl-5\">\n                  <div class=\"tw-mt-1 tw-relative tw-rounded-md tw-shadow-sm tw-h-full\">\n                    <elsa-monaco-editor\n                      key={`monaco-editor-${index}`}\n                      value={expression}\n                      language={language}\n                      singleLineMode={true}\n                      editorHeight=\"2.75em\"\n                      padding=\"tw-pt-1.5 tw-pl-1 tw-pr-28\"\n                      onValueChanged={e => this.onCaseExpressionChanged(e, switchCase)}\n                    />\n                    <div class=\"tw-absolute tw-inset-y-0 tw-right-0 tw-flex tw-items-center\">\n                      <select onChange={e => this.onCaseSyntaxChanged(e, switchCase)} class=\"focus:tw-ring-blue-500 focus:tw-border-blue-500 tw-h-full tw-py-0 tw-pl-2 tw-pr-7 tw-border-transparent tw-bg-transparent tw-text-gray-500 sm:tw-text-sm tw-rounded-md\">\n                        {supportedSyntaxes.map(supportedSyntax => {\n                          const selected = supportedSyntax == syntax;\n                          return <option selected={selected}>{supportedSyntax}</option>;\n                        })}\n                      </select>\n                    </div>\n                  </div>\n                </td>\n                <td>\n                  <button type=\"button\" onClick={() => this.onDeleteCaseClick(switchCase)} class=\"elsa-icon-button\">\n                    <TrashBinButtonIcon/>\n                  </button>\n                </td>\n              </tr>\n            );\n          })}\n          </tbody>\n        </table>\n        <div class=\"tw-p-4\">\n          <button type=\"button\" onClick={() => this.onAddCaseClick()} class=\"elsa-btn\">\n            <PlusButtonIcon/>\n            Add Case\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n"],"mappings":"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"}