import"./p-fcfa9e22.js";import{C as t,J as s}from"./p-dd7ad463.js";import{s as n}from"./p-1de51046.js";class o{constructor(t){this.activity=t,this.parents=[],this.children=[]}get nodeId(){const t=[...this.ancestors()].reverse().map((t=>t.activity.id));return t.length?`${t.join(":")}:${this.activity.id}`:this.activity.id}get activity(){return this._activity}set activity(t){this._activity=t}get parents(){return this._parents}set parents(t){this._parents=t}get children(){return this._children}set children(t){this._children=t}descendants(){const t=[];for(let i of this.children)t.push(i),t.push(...i.descendants());return t}ancestors(){const t=[];for(let i of this.parents)t.push(i),t.push(...i.ancestors());return t}siblings(){return this.parents.flatMap((t=>t.children))}siblingsAndCousins(){return this.parents.flatMap((t=>t.descendants().flatMap((t=>t.children))))}}function i(t){const i={};for(const s of t)i[s.activity.id]=s.activity;return i}function r(t){const i={};for(const s of t)i[s.activity.id]=s;return i}function c(t){const i=n.activityDescriptors,s=new Set([t]),e=new o(t);return a(e,t,s,new Set([e]),i),e}function e(t){return f([t])}function f(t){let i=[...t];for(const s of t){const t=f(s.children);i=[...i,...t]}return i}function a(t,i,s,n,e){const r=u(t,i,e);for(const i of r){let r=Array.from(n).find((t=>t.activity==i.activity));r||(r=new o(i.activity),r.port=i.port,n.has(r)||n.add(r)),r!==t&&r.activity&&(r.parents.includes(t)||r.parents.push(t),t.children.includes(r)||t.children.push(r),s.has(i.activity)||s.add(i.activity),a(r,i.activity,s,n,e))}}function u(i,n,e){const r=t.get(s).get(n.type),c=e.find((t=>t.typeName==n.type)),a=r.getOutboundPorts({activity:n,activityDescriptor:c});let o=[];const p={activityDescriptor:c,activity:n};for(const t of a){const i=r.resolvePort(t.name,p);if(Array.isArray(i)){const s=i;o=[...o,...s.map((i=>({port:t.name,activity:i})))]}else o.push({port:t.name,activity:i})}return o}export{o as A,r as a,f as b,i as c,e as f,c as w};